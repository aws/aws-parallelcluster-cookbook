# Validates orchestration recipes
---
verifier:
  name: inspec
  inspec_tests:
    - test/recipes
    - /tmp/cookbooks/aws-parallelcluster-awsbatch/test
    - /tmp/cookbooks/aws-parallelcluster-computefleet/test
    - /tmp/cookbooks/aws-parallelcluster-environment/test
    - /tmp/cookbooks/aws-parallelcluster-platform/test
    - /tmp/cookbooks/aws-parallelcluster-shared/test

lifecycle:
  pre_verify:
    - local: . ./kitchen.fix-inspec-deps.sh

suites:
  - name: aws_parallelcluster_install
    run_list:
      - recipe[aws-parallelcluster-test::docker_mock]
      - recipe[aws-parallelcluster]
      - recipe[aws-parallelcluster-tests::tear_down]
    verifier:
      controls:
        - /tag:install/
