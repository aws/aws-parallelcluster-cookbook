#
# Example slurm.conf file. Please run configurator.html
# (in doc/html) to build a configuration file customized
# for your environment.
#
#
# slurm.conf file generated by configurator.html.
#
# See the slurm.conf man page for more information.
#
# CLUSTER SETTINGS
ClusterName=<%= node['cluster']['stack_name'] %>
SlurmUser=<%= node['cluster']['slurm']['user'] %>
SlurmctldPort=6820-6829
SlurmdPort=6818
AuthType=auth/munge
StateSaveLocation=/var/spool/slurm.state
SlurmdSpoolDir=/var/spool/slurmd
SwitchType=switch/none
SlurmctldPidFile=/var/run/slurmctld.pid
SlurmdPidFile=/var/run/slurmd.pid
ReconfigFlags=KeepPartState
<% if node['cluster']['enable_nss_slurm'] == 'true' -%>
LaunchParameters=enable_nss_slurm
<% end -%>
#
# CLOUD CONFIGS OPTIONS
<% if node['cluster']['use_private_hostname'] == 'true' or node['cluster']['dns_domain'].nil? or node['cluster']['dns_domain'].empty? -%>
SlurmctldParameters=idle_on_node_suspend,power_save_min_interval=30,node_reg_mem_percent=<%= node['cluster']['slurm_node_reg_mem_percent'] %>
TreeWidth=65533
<% else -%>
SlurmctldParameters=idle_on_node_suspend,power_save_min_interval=30,cloud_dns,node_reg_mem_percent=<%= node['cluster']['slurm_node_reg_mem_percent'] %>
TreeWidth=30
<% end -%>
CommunicationParameters=NoAddrCache
SuspendProgram=<%= node['cluster']['scripts_dir'] %>/slurm/slurm_suspend
ResumeProgram=<%= node['cluster']['scripts_dir'] %>/slurm/slurm_resume
ResumeFailProgram=<%= node['cluster']['scripts_dir'] %>/slurm/slurm_suspend
RebootProgram=/sbin/reboot
SuspendTimeout=120
PrivateData=cloud
ResumeRate=0
SuspendRate=0
#
# PROLOG AND EPILOG
Prolog=<%= node['cluster']['slurm']['install_dir'] %>/etc/scripts/prolog.d/*
Epilog=<%= node['cluster']['slurm']['install_dir'] %>/etc/scripts/epilog.d/*
SchedulerParameters=nohold_on_prolog_fail
BatchStartTimeout=180
#
# TIMERS
SlurmctldTimeout=300
SlurmdTimeout=180
UnkillableStepTimeout=180
InactiveLimit=0
MinJobAge=300
KillWait=30
Waittime=0
MessageTimeout=60
AuthInfo=cred_expire=70
#
# SCHEDULING, JOB, AND NODE SETTINGS
EnforcePartLimits=ALL
SchedulerType=sched/backfill
ProctrackType=proctrack/cgroup
MpiDefault=none
ReturnToService=1
TaskPlugin=task/affinity,task/cgroup
#
# TRES AND GPU CONFIG OPTIONS
GresTypes=gpu
SelectType=select/cons_tres
#
# LOGGING
SlurmctldDebug=verbose
SlurmctldLogFile=/var/log/slurmctld.log
SlurmdDebug=info
SlurmdLogFile=/var/log/slurmd.log
DebugFlags=Power
JobCompType=jobcomp/none
#
# WARNING!!! The slurm_parallelcluster.conf file included below can be updated by the pcluster process.
# Please do not edit it.
include slurm_parallelcluster.conf

# WARNING!!! The custom_slurm_settings_include_file_slurm.conf file included below can be updated by the pcluster process.
# Please do not edit it.
include pcluster/custom_slurm_settings_include_file_slurm.conf
